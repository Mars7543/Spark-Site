<%- include ('../../partials/spark/header') %>

<div class="container applications">
    <h1 class="title">Applications</h1>

    <table class="applicants">
        <thead>
            <tr>
                <td class="name">Name</td>
                <td class="gender">Gender</td>
                <td class="academy">Academy</td>
                <td class="written">Written Application</td>
                <td class="individual">Individual Interview</td>
                <td class="group">Group Interview</td>
                <td class="total">Total</td>
            </tr>                
        </thead>
        <tbody>
            <% applications.forEach(function(applicant) { %>
                <tr class="applicant-row">
                    <td class="name"> <%= `${applicant.firstname} ${applicant.lastname}` %> </td>
                    <td class="gender"> <%= `${applicant.gender}` %> </td>
                    <td class="academy"> <%= `${applicant.academy}` %> </td>
                    <%  const written = applicant.applicant_data.written
                        let written_grade = 0
                        written.grades.forEach(function(grade) {written_grade = written_grade + grade});

                        const individual = applicant.applicant_data.individual_interview
                        let individual_grade = 0
                        individual.questionGrades.forEach(function(grade) {individual_grade = individual_grade + grade});
                        individual.grades.forEach(function(grade) {individual_grade = individual_grade + grade});

                        const group = applicant.applicant_data.group_interview
                        let group_grade = 0
                        group.grades.forEach(function(grade) {group_grade = group_grade + grade});
                    %>

                    <% if(written_grade !== 0) { %>
                        <td class="written"> <%= written_grade %> </td>
                    <% } else { %>
                        <td class="written"><a href="" class="grade-button">Grade</a></td>
                    <% } %>

                    <% if(individual_grade !== 0) { %>
                        <td class="individual"> <%= individual_grade %> </td>
                    <% } else { %>
                        <td class="individual"><a href="" class="grade-button">Grade</a></td>
                    <% } %>

                    <% if(group_grade !== 0) { %>
                        <td class="group"> <%= written_grade %> </td>
                    <% } else { %>
                        <td class="group"><a href="" class="grade-button">Grade</a></td>
                    <% } %>

                    <% let total = written_grade + individual_grade + group_grade %>
                    <td class="total"> <%= total %> </td>
                </tr>
            <% }) %>
        </tbody>
    </table>

</div>

<%- include ('../../partials/spark/footer') %>